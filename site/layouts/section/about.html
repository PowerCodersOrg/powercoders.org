{{ define "main" }}

{{ partial "jumbotron" (dict "imageUrl" .Params.image "title" .Title "subtitle" .Params.section_title) }}

<div class="container section">
  <div class="row">
    <div class="col s12 markdown">
      {{ partial "markdownify-block" .Params.text }}
    </div>
  </div>
</div>

{{ partial "parallax" (dict "parallax" .Params.video )}}

<div class="container section">
  <div class="row">
    <div class="col s12">
      <h2>Timeline</h2>
    </div>
  </div>
  <div class="row">
    <div class="col s12">
      <ul class="timeline">
        {{ range $el := .Params.timeline }}
          <li class="event" data-date="{{$el.date}}">
            <h5>{{$el.text}}</h5>
          </li>
        {{end}}
      </ul>
    </div>
  </div>
</div>

<div class="container">
    <div class="row">
        <div class="col s12 markdown">
            {{ partial "markdownify-block" .Params.team.text }}
        </div>
    </div>

    <div class="row">
      <div class="col s12">
        <div class="input-field">
          <select id="vis-selector">
            <!-- Keep list in sync with the options in config.yml -->
            <option value="">Everybody</option>
            <option value="team_zurich">Team Zurich</option>
            <option value="team_lausanne">Team Lausanne</option>
            <option value="team_turin">Team Turin</option>
            <option value="office_powercoders">Office Powercoders</option>
            <option value="switzerland">Switzerland</option>
            <option value="board_powercoders">Board Powercoders</option>
            <option value="switzerland_community">Switzerland Community</option>
          </select>
        </div>
      </div>
    </div>

    <div class="row flex portrait">
        {{ range $el := .Params.team.members }}
        <div class="col s6 m4 l3" data-visible="{{ $el.visible }}">
            <div><img src="{{$el.image}}" class="responsive"
                      alt="{{$el.name}}"></div>
            <p><strong>{{$el.name}}</strong><br>{{$el.description}}
            </p>
        </div>
        {{end}}
    </div>
</div>

<script type="text/javascript">
// Deliberately as simple as possible since it's not transpiled
var portraits = document.querySelectorAll('[data-visible]');
var numPortraits = portraits.length;
var selector = document.getElementById('vis-selector');
selector.addEventListener('change', function(event) {
  for (var i = 0; i < numPortraits; i++) {
    var portrait = portraits[i];
    if (event.target.value === '') {
      portrait.style.display = '';
      continue;
    }

    if (portrait.dataset.visible.indexOf(event.target.value) !== -1) {
      portrait.style.display = '';
    } else {
      portrait.style.display = 'none';
    }
  }
});
</script>
{{ end }}
